<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
    <title>前端播放m3u8格式视频</title>
    <link href="https://vjs.zencdn.net/7.4.1/video-js.css" rel="stylesheet">
    <script src='https://vjs.zencdn.net/7.4.1/video.js'></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/videojs-contrib-hls/5.15.0/videojs-contrib-hls.min.js" type="text/javascript"></script>
    <!-- videojs-contrib-hls 用于在电脑端播放 如果只需手机播放可以不引入 -->
</head>
<body>
    <style>
        .video-js .vjs-tech {position: relative !important;}
    </style>
    <div>
        <video id="video_player" width="660" height="364" controls="controls"></video>
    </div>
</body>
 
<script>
    function revokeUrl() {
        window.URL.revokeObjectURL(url);
    }

    // 请注意，底下的video_player为你video标签里的id
    window.onload = function() {
        //创建XMLHttpRequest对象
        var xhr = new XMLHttpRequest();
        var url = "http://192.168.50.79:8888/index"; // 这里的url为你的服务端地址
        //配置请求方式、请求地址以及是否同步
        xhr.open('POST', url, true);
        //设置请求结果类型为blob
        xhr.responseType = 'blob';
        //请求成功回调函数
        xhr.onload = function (e) {
            if (this.status == 200) {//请求成功
                //获取blob对象
                var blob = this.response;
                var video = document.getElementById('video_player');
                //获取blob对象地址，并把值赋给容器
                video.onload = function(e) {
                    window.URL.revokeObjectURL(video.src);
                };
                console.log(blob)
                var obj_url = window.URL.createObjectURL(blob);
                console.log(obj_url)
                video.src = obj_url;
                // video.play();
            }
        };
        xhr.send();
    }
</script>
